#### За какими метриками и процессами можно следить с помощью мониторинга? {#monitoring-metrics}

Для всех типов СУБД можно отслеживать:

- загрузку процессора, памяти, сети, дисков в абсолютных величинах;
- загрузку памяти, сети, дисков в процентах от установленных лимитов для класса хостов соответствующего кластера;
- объем данных кластера БД и остаток свободного места в хранилище данных.

Для всех хостов БД можно отслеживать метрики, специфические для типа соответствующей СУБД. Например для {{ PG }} можно отслеживать:
- среднее время выполнения запроса;
- количество запросов в секунду;
- количество ошибок в журналах и т. д.

Мониторинг можно осуществлять с минимальной гранулярностью в 5 секунд.

#### Как тарифицируется хранение логов? {#logging-pricing}

Логи любого уровня пишутся на системный раздел диска, под который отведено 20 ГБ, поэтому не тарифицируются отдельно. Объем создаваемых логов влияет только на частоту их ротации.

{% include [log-duration](../../_includes/mdb/log-duration-qa.md) %}

#### Как следить за свободным объемом хранилища на хостах ZooKeeper? {#zookeeper-storage}

Воспользуйтесь инструкцией в разделе [Мониторинг состояния кластера и хостов](../../managed-clickhouse/operations/monitoring.md), чтобы отслеживать состояние хостов или настроить алерты.

#### Как отслеживать объем, занимаемый данными в гибридном хранилище? {#hybrid}

Воспользуйтесь метрикой `ch_s3_disk_parts_size` в сервисе {{ monitoring-full-name }}. Она показывает, какой объем занимают куски таблиц [MergeTree]({{ ch.docs }}/engines/table-engines/mergetree-family/mergetree/) в сервисе {{ objstorage-name }}. Метрика доступна только для кластеров {{ mch-name }} с настроенным [гибридным хранилищем](../../managed-clickhouse/concepts/storage.md#hybrid-storage-features). Подробнее о том, как выполнить запрос с метрикой, см. в [руководстве](../../managed-clickhouse/tutorials/hybrid-storage.md#metrics).

#### Как настроить алерт, который срабатывает при заполнении определенного процента дискового пространства? {#disk-space-percentage}

[Создайте алерт](../../managed-clickhouse/operations/monitoring.md#monitoring-integration) с метрикой `disk.used_bytes` в сервисе {{ monitoring-full-name }}. Метрика показывает размер использованного дискового пространства в кластере {{ mch-name }}.

Для `disk.used_bytes` используются пороги для оповещения. Их рекомендуемые значения:

* `{{ ui-key.yacloud_monitoring.alert.status_alarm }}` — 95% дискового пространства.
* `{{ ui-key.yacloud_monitoring.alert.status_warn }}` — 80% дискового пространства.

Значения порогов задаются только в байтах. Например, рекомендуемые значения для диска размером в 100 ГБ:

* `{{ ui-key.yacloud_monitoring.alert.status_alarm }}` — `102005473280` байт (95%).
* `{{ ui-key.yacloud_monitoring.alert.status_warn }}` — `85899345920` байт (80%).
